<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diamond Web</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- DataTables Bootstrap 5 CSS -->
    <link href="//cdn.datatables.net/2.3.6/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <!-- Remix Icon CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet">
</head>

<body class="bg-light">

    {% include 'navbar.html' %}

    <!-- Toast Container -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    </div>

    <!-- Django Messages Data (for toasts) -->
    <div style="display:none;" data-messages='[{% for message in messages %}{"level": "{{ message.level_tag }}", "message": "{{ message|escapejs }}", "tags": "{{ message.tags }}"}{% if not forloop.last %},{% endif %}{% endfor %}]' id="messagesData"></div>

    <div class="container">
        {% block content %}
        {% endblock %}
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery and DataTables JS (imported for future integration) -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="//cdn.datatables.net/2.3.6/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.3.6/js/dataTables.bootstrap5.js"></script>
    <script>
        // Helper function to show toast notifications
        function showToast(title, message, type = 'info') {
            const toastId = 'toast-' + Date.now();
            const bgClass = type === 'success' ? 'bg-success' : type === 'danger' ? 'bg-danger' : 'bg-info';
            const toastHtml = `
                <div id="${toastId}" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
                    <div class="toast-header ${bgClass} text-white">
                        <strong class="me-auto">${title}</strong>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                    <div class="toast-body">
                        ${message}
                    </div>
                </div>
            `;
            const container = document.querySelector('.toast-container');
            container.insertAdjacentHTML('beforeend', toastHtml);
            const toastElement = document.getElementById(toastId);
            const toast = new bootstrap.Toast(toastElement);
            toast.show();
            toastElement.addEventListener('hidden.bs.toast', () => toastElement.remove());
        }

        // Display Django messages as toasts
        document.addEventListener('DOMContentLoaded', function() {
            const messagesJson = document.querySelector('[data-messages]');
            if (messagesJson) {
                try {
                    const messages = JSON.parse(messagesJson.dataset.messages);
                    messages.forEach(msg => {
                        showToast(msg.level, msg.message, msg.tags || 'info');
                    });
                } catch (e) {
                    console.error('Error parsing messages:', e);
                }
            }
        });
    </script>
    {% block scripts %}{% endblock %}
</body>

</html>